<p-dataTable [value]="applicants"
             expandableRows="true"
             selectionMode="single"
             (onRowClick)="handleRowClick($event)"
             (onRowExpand)="handleRowExpand($event)"
             [paginator]="true"
             [rows]="10">

    <p-column expander="true"
              styleClass="col-icon"
              [style]="{'width':'38px'}"></p-column>

    <p-column field="name"
              header="Name"
              [sortable]="true"
              [filter]="true"
              filterPlaceholder="Search by Name"
              filterMatchMode="contains"></p-column>

    <p-column field="status"
              [sortable]="true"
              [filter]="true"
              filterPlaceholder="Search by Last Passed"
              filterMatchMode="contains"
              header="Last Passed"></p-column>

    <p-column field="email"
              header="E-Mail"
              [sortable]="true"
              [filter]="true"
              filterPlaceholder="Search by Email"
              filterMatchMode="contains"></p-column>

    <p-column field="phoneNumber"
              header="Phone Number"
              [filter]="true"
              filterPlaceholder="Search #"
              filterMatchMode="contains"
              [style]="{'width':'145px'}"></p-column>

    <p-column field="attempts"
              header="Tries"
              [sortable]="true"
              [filter]="true"
              filterPlaceholder="#"
              filterMatchMode="contains"
              [style]="{'width':'80px'}"></p-column>

    <ng-template let-applicant pTemplate="rowexpansion">
        <div class="ui-grid"  style="font-size:14px; padding-left:38px; padding-right: 38px; padding-bottom: 30px;">
            <div *ngIf="applicant.user">
                <div class="ui-grid-row">
                    <span class="applicant-name">{{applicant.user.givenName}} {{applicant.user.familyName}}</span>
                </div>
                <div class="ui-grid-row">

                    <div class="ui-grid-col-5">
                        <p>Born in {{applicant.user.dateOfBirth}},
                            {{applicant.user.dateOfBirth | amParse:'YYYY' | amTimeAgo}},
                            applied {{applicant.user.timesApplied}} times so far.
                        </p>
                        <p><b>Process Started at </b> {{applicant.user.processStartedAt | date: 'yyyy.MM.dd. HH:mm'}}</p>
                        <span><b>Group Time:</b> {{applicant.user.screeningGroupTime | date: 'yyyy.MM.dd. HH:mm'}}</span><br />
                        <span><b>Personal Time:</b> {{applicant.user.screeningPersonalTime | date: 'yyyy.MM.dd. HH:mm'}}</span>
                        <br /><br />
                        <span><b>Screening Steps:</b> {{applicant.user.screeningSteps}}</span><br />
                        <span><b>Screening Info:</b> {{applicant.user.screeningInfo}}</span>
                        <br /><br />
                        <p><b>Final Result:</b> {{applicant.user.finalResult}}</p>
                    </div>
                    <div class="ui-grid-col-7">
                        <table class="table table-striped">
                            <thead>
                                <tr>
                                    <th>Survey</th>
                                    <th>Result</th>
                                    <th>Score</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr *ngFor="let testResult of applicant.user.testResults.reverse()">
                                    <td>{{testResult.name}}</td>
                                    <td>
                                        <i *ngIf="testResult.passed" class="fa fa-check" aria-hidden="true"></i>
                                        <i *ngIf="!testResult.passed" class="fa fa-ban" aria-hidden="true"></i>
                                    </td>
                                    <td>{{testResult.percent}}%</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </ng-template>

</p-dataTable>
<br />
<p class="pull-right">There are {{applicants.length}} active applicants for the selected location.</p>