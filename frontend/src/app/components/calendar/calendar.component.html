<div class="loading" *ngIf="loading"></div>

<div class="container">

    <div class="panel panel-default">
        <div class="panel-heading">Help</div>
        <div class="panel-body">
            On this page you can assign the <strong>Group Time</strong> and <strong>Personal Time</strong> schedules individually
            for each candidate. <br>
            If there's data about previously added schedules, it will get populated in the table below. <br>
            You can change the schedules to any date/time you want. Clicking on the <strong>Send Emails</strong>
            button is only allowed when all pending changes has been saved first. <br>

        </div>
    </div>

    <div class="panel panel-default">
        <table class="table table-striped table-bordered">
            <thead>
            <tr>
                <th>Candidate's Name</th>
                <th>Assigned Group Time</th>
                <th>Assigned Personal Time</th>
            </tr>
            </thead>
            <tbody>
            <tr *ngFor="let candidate of candidates">
                <td class="col-md-6 table-candidate-name">{{candidate.name}}</td>
                <td class="col-md-3">
                    <p-calendar [(ngModel)]="candidate.groupTime"
                                (ngModelChange)="handleGroupTimeButtonAccess()"
                                [locale]="calendarLocalization"
                                dateFormat="yy/mm/dd"
                                showTime="showTime"
                                hourFormat="24"></p-calendar>
                    <button [disabled]="!candidate.groupTime"
                            (click)="setGroupTimeToAll(candidate.groupTime)"
                            class="btn btn-primary btn-xs pull-right">Set to all</button>
                    <button [disabled]="!candidate.groupTime"
                            class="btn btn-danger btn-xs remove-button"
                            (click)="restoreGroupTimeToNull(candidate)">
                        <i class="fa fa-times"></i>
                    </button>
                </td>
                <td class="col-md-3">
                    <p-calendar [(ngModel)]="candidate.personalTime"
                                (ngModelChange)="handlePersonalTimeButtonAccess()"
                                [locale]="calendarLocalization"
                                dateFormat="yy/mm/dd"
                                showTime="showTime"
                                hourFormat="24"></p-calendar>
                    <button [disabled]="!candidate.personalTime"
                            (click)="setPersonalTimeToAll(candidate.personalTime)"
                            class="btn btn-primary btn-xs pull-right">Set to all</button>
                    <button [disabled]="!candidate.personalTime"
                            class="btn btn-danger btn-xs remove-button"
                            (click)="restorePersonalTimeToNull(candidate)">
                        <i class="fa fa-times"></i>
                    </button>
                </td>
            </tr>
            <tr>
                <th></th>
                <th><button class="btn btn-danger btn-xs pull-right save-button"
                            (click)="saveGroupTimes()"
                            [disabled]="groupTimeSaveBtnDisabled">Save Assigned Group Times</button></th>
                <th><button class="btn btn-danger btn-xs pull-right save-button"
                            (click)="savePersonalTimes()"
                            [disabled]="personalTimeSaveBtnDisabled">Save Assigned Group Times</button></th>
            </tr>
            </tbody>
        </table>
    </div>



    <div class="panel panel-default">
        <div class="panel-heading clearfix">
            Sending Notification E-mails
            <button class="btn btn-danger pull-right btn-xs send-email-button"
                    [disabled]="!groupTimeSaveBtnDisabled || !personalTimeSaveBtnDisabled">Send Emails</button>
        </div>
        <div class="panel-body">


            The screening notification email will be sent only to those candidates
            whose <strong>Group Time</strong> and <strong>Personal Time</strong> schedules are present.
            <br>
            If both or at least one of the schedules are missing, no email will be sent to those candidates.
            <br>
            <br>
            The following people will receive an email with the assigned schedules when you click <strong>Send Emails</strong>.
            <br>
            <ol>
                <li *ngFor="let candidate of getCandidatesWithValidSchedules()">
                    <strong>{{candidate.name}}</strong> /
                    GT
                    <strong>{{candidate.groupTime | date: 'yyyy.MM.dd. HH:mm'}}</strong> /
                    PT
                    <strong>{{candidate.personalTime |date: 'yyyy.MM.dd. HH:mm'}}</strong>
                </li>
            </ol>
        </div>
    </div>



    <!--<div class="col-sm-12 panel panel-warning">-->
        <!--<div class="panel-body">-->
            <!--<span>You can assign screening times here. Please first always assign group times,-->
                <!--since the personal times assignment will trigger an email sending.-->
                <!--<br />Note: Emails will be sent only if the assigned dates are new, or changed.-->
            <!--</span>-->
        <!--</div>-->
    <!--</div>-->

    <!-- Left side - date picker -->
    <!--<div class="col-xs-12 col-sm-12 col-md-4 col-lg-4">-->
        <!--<div class="card">-->
            <!--<h3>Group screening dates</h3>-->
            <!--<div class="row">-->
                <!--<div *ngFor="let screeningDates of screeningDates.sort()" class="date-button-container">-->
                    <!--<h4 class="text-info">-->
                        <!--<i class="fa fa-calendar"></i>&nbsp;-->
                        <!--{{ screeningDates | date: 'yyyy.MM.dd. HH:mm' }}-->
                    <!--</h4>-->
                <!--</div>-->
                <!--<hr />-->
            <!--</div>-->
            <!--<div class="row">-->
                <!--<div class="col-xs-12 col-sm-12 col-md-8 col-lg-8">-->
                    <!--<p-calendar-->
                            <!--[(ngModel)]="date"-->
                            <!--showTime="showTime"-->
                            <!--dateFormat="yy.mm.dd."-->
                            <!--[minDate]="minDate"-->
                            <!--[locale]="calendarLocalization"-->
                            <!--hourFormat="24">-->
                    <!--</p-calendar>-->
                <!--</div>-->
                <!--<div class="col-xs-12 col-sm-12 col-md-4 col-lg-4">-->
                    <!--<span>-->
                    <!--<a (click)="addDate()">-->
                        <!--<i class="fa fa-plus text-success" aria-hidden="true">&nbsp;Add new</i>-->
                    <!--</a>-->
                    <!--</span>-->
                <!--</div>-->
            <!--</div>-->
        <!--</div>-->
    <!--</div>-->

    <!-- Right side - assign applicant to group/individual -->
    <!--<div class="col-xs-12 col-sm-12 col-md-8 col-lg-8">-->

        <!--&lt;!&ndash; Group times &ndash;&gt;-->
        <!--<div class="row">-->
            <!--<h2>Group screening times</h2>-->

            <!--<div *ngFor="let user of candidates">-->
                <!--<calendar-group-date-assignment-->
                        <!--[dates]="selectDates"-->
                        <!--[user]="user"-->
                <!--&gt;</calendar-group-date-assignment>-->
            <!--</div>-->
        <!--</div>-->
        <!--<br />-->
        <!--<div class="row">-->
            <!--<button class="btn btn-success" (click)="saveGroupTimes()">Save group times</button>-->
        <!--</div>-->

        <!--<br />-->

        <!--<div class="row">-->
            <!--<h2>Personal screening times</h2>-->
            <!--<div *ngFor="let user of candidates">-->
                <!--<calendar-personal-date-assignment-->
                    <!--[user]="user"-->
                <!--&gt;-->
                <!--</calendar-personal-date-assignment>-->
            <!--</div>-->
        <!--</div>-->
        <!--<br />-->
        <!--<div class="row">-->
            <!--<button class="btn btn-success" (click)="savePersonalTimes()">Save personal times and send emails</button>-->
        <!--</div>-->


    <!--</div>-->
</div>